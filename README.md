# -淘淘商城项目总结
# -学习的内容
# -第一天：
学习电商行业的背景，电商模式：B2B,B2C,B2B2C,O2O;
分布式，集群的理解;系统的架构
使用Maven搭建后台工程，及SVN的使用；
# -第二天：
	dubbo的学习和使用,系统和系统之间通信的中间件；
	webservice ：系统之间通信。应用于外部系统，并且数据交换不是特别大的情况下（传统行业 OA 与ERP之间的通信）
	http+json: 系统之间通信 。属于http的协议，restful风格传递数据，（手机客户端和后台进行通信 SSO系统给手机发布接口调用，传递JSON）
	dubbo:系统之间的通信.    属于RPC的协议（底层二进制协议），使用socket 通信，传输效率高，一般用于内部系统之间。作为SOA架构的管理工具，能统计各个服务调用的次数。

SSM的整合，逆向工程产生，商品列表展示，分页插件的使用，Easyui的使用（datagrid的使用查询商品列表）。
	学习dubbo的架构及4个角色，如何在spring使用。dubbo的使用贯穿于整合项目，有服务层和表现层的交互就需要使用dubbo。
第三天：
	商品类目的选择，使用EasyUI的tree控件。传统图片上传功能，上传到某一个tomcat,在集群环境下，上传之后，有可能由另一台提供服务，图片不存在，所以需要单独建立图片服务器。
在集群环境下使用FASTDFS 来存储图片。（会使用FASTDFS客户端上传下载图片即可） 还有富文本编辑器KindEditor的使用。
	富文本编辑器：引入JS ； 定义好数据源（textarea）;表单提交之前，同步数据，将富文本编辑器中的内容同步到textarea中。
第四天：
	首页系统(portal) 的搭建 ，使用伪静态URL拦截形式:*.html。(搜索引擎优化)
首页的数据应当动态展示，需要有一个CMS系统来动态维护（CMS:内容管理系统），就是内容和内容分类管理。轮播图的动态展示。

首页访问压力很大，需要做缓存。
第五天：
	在首页中的访问压力特别大，需要解决高并发的问题，使用缓存技术，学习了redis技术，并使用redis的客户端 jedis在内容获取时的服务层中添加缓存及缓存同步。
	redis :就是一种以KEY-VALUE形式存储数据在内存中的技术。（主要用于缓存）。
	set 
	get 
	expire
	incr 
	keys * 
    五种存储数据类型：
		String  hash  list  set  sortedset.

	sortedset 用于做排行榜，有序，并且不重复。

	redis的持久化方案：RDB AOF   RDB:快照    AOF:append only file .redis中的每一个操作都记录起来。一旦重启，就可以将原来数据恢复。
	需要手动开启AOF持久化方案，默认是开启RDB

	redis服务器的搭建及集群搭建（奇数结点） 因为：redis集群中有投票机制，半数以上投票。
	

注意：添加缓存的逻辑不能影响正常的业务逻辑。应用最多的数据类型（String和hash）

第六,七天
	lucene是一个全文检索的工具包，提供很多的检索使用的API。

	在首页中如果找不到对应的商品，就需要搜索商品，实现搜索的技术是lucene/solr。
学习了lucene相关的介绍，应用场景，以及实现全文检索的流程。
索引流程及搜索流程。
学习入门程序：索引流程的代码实现。luke的使用。
学习入门程序：搜索流程的代码实现。
索引域及文档的域，以及Field域的说明(是否分词，是否索引，是否存储)
	
索引的维护；
搜索的两种类型（使用query子类及queryParser） 及lucene搜索相关的语法。
最简单的语法：field:value   从field查询包含value的值的数据。
分词的过程：
	分词 （英文单词，按空格分词）---》过滤（标点符号去掉）--》大写转小写---》去掉停用词。

中文分词器的IKAnalyzer的使用。
	jar包添加到工程build path  
	配置文件（xx.cfg.xml,扩展词典，停用词词典）放入classes下
	定义业务域。
特点：可以扩展，可以维护，支持中文分词。

第八天
solr 是(基于lucene)搜索引擎 ，可以独立部署，来实现搜索功能，高亮显示，性能优化，可以解决高并发的搜索需求。
lucene 和solr的区别：
	1.lucene 工具包 solr 服务器  （打比方：solr是汽车，lucene是汽车引擎）
	2.lucene 的业务域不需要先定义后使用，solr必须是先定义后使用。
	3.lucene加入应用系统的时候，耦合度 很高不易扩展
	4.solr是服务器，只需要通过http请求操作索引。维护，升级方便，并且做性能优化。

	使用solrj作为java的客户端操作索引和搜索。
    京东案例的实现。使用IK分词器 配置在schema.xml中
第九天
	taotao商城的solr服务在linux的搭建，搜索服务层系统的搭建，表现层搭建，并使用solr实现商品搜索功能（中文分析器的配置，业务域定义，导入数据到索引库，搜索功能的实现）。

solr分页  通过solrj 设置start  设置rows.默认查询是10条。
查询的时候需要指定默认的搜索域。
第十天：
	在并发量特别大的情况下，一个solr服务器无法满足要求，学习了solr集群在linux下的搭建；参考教案。
测试了solrj的集群版的使用；将搜索功能切换到集群版 ；

全局异常处理：需要创建一个类实现全局异常处理器的接口（handlerexceptionresolver） 配置在配置文件（springmvc）中。
全局异常处理中实现：
	日志处理，
	发送异常信息邮件给相关人员，
	响应一个友好的错误页面给客户。
第十一天：
	索引库需要同步时，可以使用异步消息的中间件(activemq) 来实现索引库的同步。

Activemq的使用场景：
     不需要同步等待时系统之间的通信使用。比如：订单系统 产生订单后，需要发送响应给客户，提示成功。但不需要等待用户点击确定后才继续产生订单。订单系统只需要产生订单后，异步发送一个消息，又继续执行下一个产生订单逻辑而不需要再等待页面响应。
同步索引库。
同步缓存
生成静态页面

传递消息的类型：
	PTP ------>queue-------默认缓存mq服务器上,只能被一个消费者接收
	publish/subscribe------topic默认是不缓存 可以被多个消费者接收。（先订阅）

	消息的格式（JMS的规范） 6种格式。TxtMessage  ObjectMessage  byteMessage....
	
	一般是和spring进行整合使用。
	发送端 :JMSTemplate 发送消息
	接收端：使用设置一个监听容器--->指定监听器 (MessageListener)
第十二天：
	商品详情的系统搭建 （参考京东，访问商品详情时，域名已经变化）。
使用jsp和redis 实现页面的高性能动态展示；
如果高并发量：需要实现网页静态化来提升响应速度。
freemarker可实现网页静态化，使用freemarker的常用语法学习。实现网页静态化的方案实现。通过使用activemq实现同步生成静态网页
	实现网页静态化的方案：
	部署不同的服务器上的（taoao-item-web）工程，分别订阅了 topic (当商品添加/更新的时候发送的topic 包含商品id),工程接收到消息，产生静态页面。工程所在的服务器上再部署一个http服务器，来指定静态页面的目录，提供浏览器访问静态页面 提升效率。
第十三天：
	在实现静态化的方案中需要使用nginx，需要学习nginx 。nginx能实现的功能：
1.配置虚拟主机，copy server结点即可
2.反向代理     设置upstream 来指定服务的ip地址和端口，在location结点 设置proxy_pass=http://upstream.参考教案。
3.负载均衡
4.作为Http服务器
学习实现nginx的高可用的原理。
第十四天：
	SSO系统的搭建，注册，登录，通过token获取用户信息。实现SSO服务，提供给其他客户端接口。
	登录流程：用户填入用户名和密码，如果正确 ，key 是一个uuid生成的唯一值（token）。用户信息存储到redis中，设置此key的有效期模拟session:30分钟,设置到cookie中（跨域：访问的端口不同，域名不同）。
	JSONP的技术：登录之后 在首页需要显示用户信息。使用JSONP 来实现 ajax 跨域。
	

第十五天：
	SSO系统的接口的开发完成及购物车实现以及订单确认页面实现。

	购物车 使用cookie来存放。有缺点：更换设备不能同步数据，存储的容量有限，如果cookie一旦被禁用，无法使用。
	方案： 
	在用户未登录的情况下，继续使用cookie来存放购物车，展示列表以cookie为准。
一旦用户登录，将cookie的数据同步到数据库中(redis) ,删除cookie的内容，展示购物车列表就以redis中的数据为准，后续的添加到购物车也需要添加到redis中。

	进入订单确认页面，需要认证身份，通过拦截器来实现。
第十六天
	订单提交的功能实现。项目的部署，mysql的linux的安装，系统的网络拓扑图，服务器的域名规划，服务器的数量规划及部署。使用tomcat的热部署 。反向代理的配置。
